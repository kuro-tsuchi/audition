<!DOCTYPE html>
<html lang="en-EN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <title>1. basic | 努力！奋斗！</title><meta name="description" content="">
    <link rel="preload" href="/audition/assets/js/runtime~app.d53e597b.js" as="script"><link rel="preload" href="/audition/assets/css/styles.81f20975.css" as="style"><link rel="preload" href="/audition/assets/js/812.cf73d600.js" as="script"><link rel="preload" href="/audition/assets/js/app.44937fea.js" as="script">
    <link rel="stylesheet" href="/audition/assets/css/styles.81f20975.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/audition/" class=""><!----><span class="site-name can-hide">努力！奋斗！</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/audition/" class="nav-link" aria-label="home"><!--[--><!--]--> home <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="java"><span class="title">java</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="java"><span class="title">java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/java/basic" class="nav-link" aria-label="basic"><!--[--><!--]--> basic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/collection" class="nav-link" aria-label="collection"><!--[--><!--]--> collection <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/multithreadingbasic" class="nav-link" aria-label="multithreadingbasic"><!--[--><!--]--> multithreadingbasic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/multithreadingadvanced" class="nav-link" aria-label="multithreadingadvanced"><!--[--><!--]--> multithreadingadvanced <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/jvm" class="nav-link" aria-label="jvm"><!--[--><!--]--> jvm <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="spring"><span class="title">spring</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="spring"><span class="title">spring</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/spring/springboot" class="nav-link" aria-label="springboot"><!--[--><!--]--> springboot <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/spring/mybatis" class="nav-link" aria-label="mybatis"><!--[--><!--]--> mybatis <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="mq"><span class="title">mq</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="mq"><span class="title">mq</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/mq/summary" class="nav-link" aria-label="summary"><!--[--><!--]--> summary <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/mq/rabbitmq" class="nav-link" aria-label="rabbitmq"><!--[--><!--]--> rabbitmq <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/mq/kafka" class="nav-link" aria-label="kafka"><!--[--><!--]--> kafka <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/mq/rocketmq" class="nav-link" aria-label="rocketmq"><!--[--><!--]--> rocketmq <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="database"><span class="title">database</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="database"><span class="title">database</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/database/distributed" class="nav-link" aria-label="distributed"><!--[--><!--]--> distributed <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/database/mysql" class="nav-link" aria-label="mysql"><!--[--><!--]--> mysql <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/database/redis" class="nav-link" aria-label="redis"><!--[--><!--]--> redis <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/database/elasticsearch" class="nav-link" aria-label="elasticsearch"><!--[--><!--]--> elasticsearch <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="distributed"><span class="title">distributed</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="distributed"><span class="title">distributed</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/distributed/summary" class="nav-link" aria-label="summary"><!--[--><!--]--> summary <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/distributed/zookeeper" class="nav-link" aria-label="zookeeper"><!--[--><!--]--> zookeeper <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/distributed/dubbo" class="nav-link" aria-label="dubbo"><!--[--><!--]--> dubbo <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/distributed/springcloud" class="nav-link" aria-label="springcloud"><!--[--><!--]--> springcloud <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="additional"><span class="title">additional</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="additional"><span class="title">additional</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/additional/network" class="nav-link" aria-label="network"><!--[--><!--]--> network <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/additional/linux" class="nav-link" aria-label="linux"><!--[--><!--]--> linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/additional/designPattern" class="nav-link" aria-label="designPattern"><!--[--><!--]--> designPattern <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="golang"><span class="title">golang</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="golang"><span class="title">golang</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/golang/codingstandard" class="nav-link" aria-label="codingstandard"><!--[--><!--]--> codingstandard <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/golang/basic" class="nav-link router-link-active" aria-label="basic"><!--[--><!--]--> basic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/golang/concurrency" class="nav-link" aria-label="concurrency"><!--[--><!--]--> concurrency <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/golang/distributed" class="nav-link" aria-label="distributed"><!--[--><!--]--> distributed <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/audition/interview/" class="nav-link" aria-label="interview"><!--[--><!--]--> interview <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="business"><span class="title">business</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="business"><span class="title">business</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/business/summary" class="nav-link" aria-label="summary"><!--[--><!--]--> summary <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/audition/" class="nav-link" aria-label="home"><!--[--><!--]--> home <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="java"><span class="title">java</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="java"><span class="title">java</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/java/basic" class="nav-link" aria-label="basic"><!--[--><!--]--> basic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/collection" class="nav-link" aria-label="collection"><!--[--><!--]--> collection <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/multithreadingbasic" class="nav-link" aria-label="multithreadingbasic"><!--[--><!--]--> multithreadingbasic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/multithreadingadvanced" class="nav-link" aria-label="multithreadingadvanced"><!--[--><!--]--> multithreadingadvanced <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/java/jvm" class="nav-link" aria-label="jvm"><!--[--><!--]--> jvm <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="spring"><span class="title">spring</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="spring"><span class="title">spring</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/spring/springboot" class="nav-link" aria-label="springboot"><!--[--><!--]--> springboot <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/spring/mybatis" class="nav-link" aria-label="mybatis"><!--[--><!--]--> mybatis <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="mq"><span class="title">mq</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="mq"><span class="title">mq</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/mq/summary" class="nav-link" aria-label="summary"><!--[--><!--]--> summary <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/mq/rabbitmq" class="nav-link" aria-label="rabbitmq"><!--[--><!--]--> rabbitmq <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/mq/kafka" class="nav-link" aria-label="kafka"><!--[--><!--]--> kafka <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/mq/rocketmq" class="nav-link" aria-label="rocketmq"><!--[--><!--]--> rocketmq <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="database"><span class="title">database</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="database"><span class="title">database</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/database/distributed" class="nav-link" aria-label="distributed"><!--[--><!--]--> distributed <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/database/mysql" class="nav-link" aria-label="mysql"><!--[--><!--]--> mysql <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/database/redis" class="nav-link" aria-label="redis"><!--[--><!--]--> redis <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/database/elasticsearch" class="nav-link" aria-label="elasticsearch"><!--[--><!--]--> elasticsearch <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="distributed"><span class="title">distributed</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="distributed"><span class="title">distributed</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/distributed/summary" class="nav-link" aria-label="summary"><!--[--><!--]--> summary <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/distributed/zookeeper" class="nav-link" aria-label="zookeeper"><!--[--><!--]--> zookeeper <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/distributed/dubbo" class="nav-link" aria-label="dubbo"><!--[--><!--]--> dubbo <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/distributed/springcloud" class="nav-link" aria-label="springcloud"><!--[--><!--]--> springcloud <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="additional"><span class="title">additional</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="additional"><span class="title">additional</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/additional/network" class="nav-link" aria-label="network"><!--[--><!--]--> network <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/additional/linux" class="nav-link" aria-label="linux"><!--[--><!--]--> linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/additional/designPattern" class="nav-link" aria-label="designPattern"><!--[--><!--]--> designPattern <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="golang"><span class="title">golang</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="golang"><span class="title">golang</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/golang/codingstandard" class="nav-link" aria-label="codingstandard"><!--[--><!--]--> codingstandard <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/golang/basic" class="nav-link router-link-active" aria-label="basic"><!--[--><!--]--> basic <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/golang/concurrency" class="nav-link" aria-label="concurrency"><!--[--><!--]--> concurrency <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/audition/golang/distributed" class="nav-link" aria-label="distributed"><!--[--><!--]--> distributed <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a href="/audition/interview/" class="nav-link" aria-label="interview"><!--[--><!--]--> interview <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="business"><span class="title">business</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="business"><span class="title">business</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/audition/business/summary" class="nav-link" aria-label="summary"><!--[--><!--]--> summary <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">golang</p><ul class=""><li><!--[--><a href="/audition/golang/codingstandard.html" class="nav-link sidebar-item" aria-label="1. Go 语言编码规范"><!--[--><!--]--> 1. Go 语言编码规范 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="1. basic"><!--[--><!--]--> 1. basic <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-1-go-和-java-的区别有" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.1. Go 和 Java 的区别有"><!--[--><!--]--> 1.1. Go 和 Java 的区别有 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-2-go-有什么优势或者特点" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.2. go 有什么优势或者特点?"><!--[--><!--]--> 1.2. go 有什么优势或者特点? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-3-golang数据类型" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.3. golang数据类型"><!--[--><!--]--> 1.3. golang数据类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-4-go中new和make的区别" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.4. go中new和make的区别"><!--[--><!--]--> 1.4. go中new和make的区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-5-go-语言如何高效的进行字符串拼接" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.5. go 语言如何高效的进行字符串拼接"><!--[--><!--]--> 1.5. go 语言如何高效的进行字符串拼接 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-6-数组-array-和切片-slice-的区别" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.6. 数组(array)和切片(slice)的区别"><!--[--><!--]--> 1.6. 数组(array)和切片(slice)的区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-7-切片长度和容量区别" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.7. 切片长度和容量区别"><!--[--><!--]--> 1.7. 切片长度和容量区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-8-for-range-循环遍历-slice-map-有什么问题" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.8. for-range 循环遍历 slice/map 有什么问题?"><!--[--><!--]--> 1.8. for-range 循环遍历 slice/map 有什么问题? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-9-golang中-int-int8-int16-int32-int64的区别和取值" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.9. golang中 int int8 int16 int32 int64的区别和取值"><!--[--><!--]--> 1.9. golang中 int int8 int16 int32 int64的区别和取值 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-10-介绍-rune-类型" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.10. 介绍 rune 类型"><!--[--><!--]--> 1.10. 介绍 rune 类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-11-golang-中解析-tag-是怎么实现的-反射原理是什么" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.11. golang 中解析 tag 是怎么实现的?反射原理是什么?"><!--[--><!--]--> 1.11. golang 中解析 tag 是怎么实现的?反射原理是什么? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-12-golang-传参是值传递还是引用传递" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.12. golang 传参是值传递还是引用传递?"><!--[--><!--]--> 1.12. golang 传参是值传递还是引用传递? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-13-struct-能不能进行比较" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.13. struct 能不能进行比较?"><!--[--><!--]--> 1.13. struct 能不能进行比较? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-14-go-闭包" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.14. go 闭包"><!--[--><!--]--> 1.14. go 闭包 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-15-golang-map-是线程安全的吗-go-如何解决-map-并发读写安全问题" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.15. golang map 是线程安全的吗? go 如何解决 Map 并发读写安全问题 ?"><!--[--><!--]--> 1.15. golang map 是线程安全的吗? go 如何解决 Map 并发读写安全问题 ? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-16-map-中删除一个-key-它的内存会释放么" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.16. map 中删除一个 key, 它的内存会释放么?"><!--[--><!--]--> 1.16. map 中删除一个 key, 它的内存会释放么? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-17-空-map-和未初始化-map-注意事项" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.17. 空 map 和未初始化 map 注意事项"><!--[--><!--]--> 1.17. 空 map 和未初始化 map 注意事项 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-18-map-的数据结构是什么-是怎么实现扩容" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.18. map 的数据结构是什么?是怎么实现扩容?"><!--[--><!--]--> 1.18. map 的数据结构是什么?是怎么实现扩容? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-19-map-如何顺序读取" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.19. map 如何顺序读取?"><!--[--><!--]--> 1.19. map 如何顺序读取? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-20-简单描述-go-语言-gc-垃圾回收-的工作原理" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.20. 简单描述 go 语言 GC(垃圾回收)的工作原理"><!--[--><!--]--> 1.20. 简单描述 go 语言 GC(垃圾回收)的工作原理 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-21-为什么小对象多了会造成gc压力" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.21. 为什么小对象多了会造成GC压力"><!--[--><!--]--> 1.21. 为什么小对象多了会造成GC压力 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-22-请简述-go-是如何分配内存的" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.22. 请简述 go 是如何分配内存的?"><!--[--><!--]--> 1.22. 请简述 go 是如何分配内存的? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-23-client-如何实现长连接" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.23. client 如何实现长连接?"><!--[--><!--]--> 1.23. client 如何实现长连接? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-24-分布式锁的问题吗-分布式锁的原理你清楚吗" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.24. 分布式锁的问题吗?分布式锁的原理你清楚吗?"><!--[--><!--]--> 1.24. 分布式锁的问题吗?分布式锁的原理你清楚吗? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-25-go-实现-set-类型" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.25. go 实现 set 类型"><!--[--><!--]--> 1.25. go 实现 set 类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-26-了解空指针吗" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.26. 了解空指针吗"><!--[--><!--]--> 1.26. 了解空指针吗 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-27-内存逃逸" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.27. 内存逃逸"><!--[--><!--]--> 1.27. 内存逃逸 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-28-golang的init函数" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.28. golang的init函数"><!--[--><!--]--> 1.28. golang的init函数 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-29-go语言局部变量分配在栈还是堆" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.29. go语言局部变量分配在栈还是堆"><!--[--><!--]--> 1.29. go语言局部变量分配在栈还是堆 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-30-golang函数返回局部变量的指针是否安全" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.30. golang函数返回局部变量的指针是否安全"><!--[--><!--]--> 1.30. golang函数返回局部变量的指针是否安全 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-31-go中两个nil可能不相等吗" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.31. go中两个nil可能不相等吗"><!--[--><!--]--> 1.31. go中两个nil可能不相等吗 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-32-非接口的任意类型-t-能够调用-t-的方法吗-反过来呢" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.32. 非接口的任意类型 T() 能够调用 *T 的方法吗? 反过来呢?"><!--[--><!--]--> 1.32. 非接口的任意类型 T() 能够调用 *T 的方法吗? 反过来呢? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-33-golang判断map中key是否存在的方法" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.33. golang判断map中key是否存在的方法"><!--[--><!--]--> 1.33. golang判断map中key是否存在的方法 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-34-golang比较两个字符串切片是否相等" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.34. golang比较两个字符串切片是否相等"><!--[--><!--]--> 1.34. golang比较两个字符串切片是否相等 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-35-go-打印结构体-使用-v-v-v-的区别" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.35. go 打印结构体,  使用 %v %+v %#v 的区别"><!--[--><!--]--> 1.35. go 打印结构体,  使用 %v %+v %#v 的区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-36-golang的枚举类型" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.36. golang的枚举类型"><!--[--><!--]--> 1.36. golang的枚举类型 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-37-go-空结构体-struct-的用途" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.37. go 空结构体 struct{} 的用途"><!--[--><!--]--> 1.37. go 空结构体 struct{} 的用途 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-38-go中的nil切片和空切片区别" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.38. go中的nil切片和空切片区别"><!--[--><!--]--> 1.38. go中的nil切片和空切片区别 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-39-go的defer原理是什么" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.39. go的defer原理是什么"><!--[--><!--]--> 1.39. go的defer原理是什么 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-40-闭包与匿名函数" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.40. 闭包与匿名函数"><!--[--><!--]--> 1.40. 闭包与匿名函数 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-41-go的-slice如何扩容" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.41. go的 slice如何扩容"><!--[--><!--]--> 1.41. go的 slice如何扩容 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-42-同步-异步和阻塞-非阻塞的区别" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.42. 同步, 异步和阻塞, 非阻塞的区别?"><!--[--><!--]--> 1.42. 同步, 异步和阻塞, 非阻塞的区别? <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/audition/golang/basic.html#_1-43-golang-中切片去重" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="1.43. golang 中切片去重"><!--[--><!--]--> 1.43. golang 中切片去重 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/audition/golang/concurrency.html" class="nav-link sidebar-item" aria-label="1. concurrency"><!--[--><!--]--> 1. concurrency <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/audition/golang/distributed.html" class="nav-link sidebar-item" aria-label="1. distributed"><!--[--><!--]--> 1. distributed <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="_1-basic" tabindex="-1"><a class="header-anchor" href="#_1-basic" aria-hidden="true">#</a> 1. basic</h1><h2 id="_1-1-go-和-java-的区别有" tabindex="-1"><a class="header-anchor" href="#_1-1-go-和-java-的区别有" aria-hidden="true">#</a> 1.1. Go 和 Java 的区别有</h2><ol><li>性能上: golang 的性能比 Java 更好,占用内存更少,使用 goroutine 避免内核态和用户态切换成本.</li><li>编译部署:Java 通过虚拟机编译,使用 JVM 跨平台编译;Go 中不存在虚拟机,针对不同的平台,编译对应的机器码;</li><li>访问权限: java 使用 public,protected,private,默认等关键字;golang 通过大小写控制.</li><li>接口: java 等面向对象编程的接口是侵入式接口,需要明确声明自己实现了某个接口. 而 Golang 的非侵入式接口不需要通过任何关键字,只要一个类型实现了接口的所有方法,就是这个接口的实现.</li><li>异常处理:java 中错误(Error)和异常 (Exception) 被分类管理,golang 中只有 error,一旦发生错误逐层返回,直到被处理.</li><li>继承:Java 的继承通过 extends 关键字完成,不支持多继承;Go 语言的继承通过 Struct 的方式,子类只需要把基类作为成员放在子类的定义中,支持多继承.</li><li>多态:java 的多态,必须满足继承,重写,向上转型;在 Go 语言中通过接口实现多态,对接口的实现只需要某个类型 T 实现了接口中的方法,就相当于实现了该接口.</li><li>值传递和引用传递:java 中不存在显式的指针,而 Golang 中存在显式的指针操作.java 和 golang 都是只存在值传递.</li><li>并发:在 Java 中,通常借助于共享内存(全局变量)作为线程间通信的媒介,通常会有线程不安全问题,使用了加锁(同步化),使用原子类,使用 volatile 提升可见性等解决;但在 Golang 中使用的是通道(channel)作为协程间通信的媒介,多个 goroutine 之间通过 Channel 来通信,chan 的读取和写入操作为原子操作,所以是安全的.</li><li>垃圾回收和内存管理机制:Java 基于 JVM 虚拟机的分代收集算法完成 GC,golang 内存释放语言层面,对不再使用的内存资源进行自动回收,多级缓存,非分代,并发的三色标记算法.</li></ol><h2 id="_1-2-go-有什么优势或者特点" tabindex="-1"><a class="header-anchor" href="#_1-2-go-有什么优势或者特点" aria-hidden="true">#</a> 1.2. go 有什么优势或者特点?</h2><ol><li>go 允许跨平台编译,编译出来的是二进制的可执行文件,部署在对应系统上即可运行</li><li>go 天生支持高并发,通过 goroutine 和 channel 实现</li><li>go 是静态类型语言,可以在编译的时候检查出来隐藏的大多数问题</li><li>go 的代码风格是强制性的统一</li></ol><h2 id="_1-3-golang数据类型" tabindex="-1"><a class="header-anchor" href="#_1-3-golang数据类型" aria-hidden="true">#</a> 1.3. golang数据类型</h2><h3 id="_1-3-1-值类型" tabindex="-1"><a class="header-anchor" href="#_1-3-1-值类型" aria-hidden="true">#</a> 1.3.1. 值类型</h3><p>int,float,bool,string,struct和array. 变量直接存储值,分配在栈区的内存空间,这些变量所占据的空间在函数被调用完后会自动释放.</p><h3 id="_1-3-2-引用类型" tabindex="-1"><a class="header-anchor" href="#_1-3-2-引用类型" aria-hidden="true">#</a> 1.3.2. 引用类型</h3><p>slice,map,chan和 指针. 变量存储的是一个地址,使用指针指向内存中真正存储数据的首地址.内存通常在堆上分配,通过GC回收.对于引用类型的变量,不仅要声明变量,还需要手动分配空间.</p><h2 id="_1-4-go中new和make的区别" tabindex="-1"><a class="header-anchor" href="#_1-4-go中new和make的区别" aria-hidden="true">#</a> 1.4. go中new和make的区别</h2><p>new 和 make 是两个内置函数,主要用来创建并分配内存.</p><h3 id="_1-4-1-make-函数" tabindex="-1"><a class="header-anchor" href="#_1-4-1-make-函数" aria-hidden="true">#</a> 1.4.1. make 函数</h3><p>make 是用于内存分配的, make 只用于 chan, map, slice 的内存分配及初始化, 它返回的是类型本身, 而不是指针类型</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// func make(t Type, size ...IntegerType) Type</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> v <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// [0 0 0 0 0]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_1-4-2-new-函数" tabindex="-1"><a class="header-anchor" href="#_1-4-2-new-函数" aria-hidden="true">#</a> 1.4.2. new 函数</h3><p>new 函数根据传入的类型分配内存空间,并返回指向该类型内存地址的指针, 同时 new 函数会把分配的内存置为零值</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// func new(Type) *Type</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> sum <span class="token operator">*</span><span class="token builtin">int</span>
    sum <span class="token operator">=</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token comment">//分配空间</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>sum<span class="token punctuation">)</span> <span class="token comment">// 0</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span> <span class="token comment">// 0xc0000aa058</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_1-5-go-语言如何高效的进行字符串拼接" tabindex="-1"><a class="header-anchor" href="#_1-5-go-语言如何高效的进行字符串拼接" aria-hidden="true">#</a> 1.5. go 语言如何高效的进行字符串拼接</h2><p>通过基准测试 benchmark 对比, 使用 strings.builder 进行字符串拼接都是最高效的; 如果进行少量的字符串拼接时,直接使用+操作符是最方便也是性能最高的</p><h3 id="_1-5-1-原生拼接方式" tabindex="-1"><a class="header-anchor" href="#_1-5-1-原生拼接方式" aria-hidden="true">#</a> 1.5.1. 原生拼接方式&quot;+&quot;</h3><p>go 语言原生支持使用+操作符直接对两个字符串进行拼接, 会对字符串进行遍历,计算并开辟一个新的空间来存储原来的两个字符串.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> s <span class="token builtin">string</span>
s <span class="token operator">+=</span> <span class="token string">&quot;asong&quot;</span>
s <span class="token operator">+=</span> <span class="token string">&quot;真帅&quot;</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_1-5-2-strings-builder" tabindex="-1"><a class="header-anchor" href="#_1-5-2-strings-builder" aria-hidden="true">#</a> 1.5.2. Strings.builder</h3><p>go 语言提供了一个专门操作字符串的库 strings,使用 strings.Builder 可以进行字符串拼接,提供了 writeString 方法拼接字符串,使用方式如下:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code> <span class="token keyword">var</span> builder strings<span class="token punctuation">.</span>Builder
 builder<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span><span class="token string">&quot;asong&quot;</span><span class="token punctuation">)</span>
 builder<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span><span class="token string">&quot; hello&quot;</span><span class="token punctuation">)</span>
 s <span class="token operator">:=</span> builder<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_1-5-3-strings-join" tabindex="-1"><a class="header-anchor" href="#_1-5-3-strings-join" aria-hidden="true">#</a> 1.5.3. strings.join</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>baseSlice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;asong&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;真帅&quot;</span><span class="token punctuation">}</span>
strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>baseSlice<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_1-5-4-字符串格式化函数-fmt-sprintf" tabindex="-1"><a class="header-anchor" href="#_1-5-4-字符串格式化函数-fmt-sprintf" aria-hidden="true">#</a> 1.5.4. 字符串格式化函数 fmt.Sprintf</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>str <span class="token operator">:=</span> <span class="token string">&quot;asong&quot;</span>
str <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%s%s&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> str<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>fmt.Sprintf 实现原理主要是使用到了反射,反射会产生性能的损耗,影响性能</p><h3 id="_1-5-5-bytes-buffer" tabindex="-1"><a class="header-anchor" href="#_1-5-5-bytes-buffer" aria-hidden="true">#</a> 1.5.5. bytes.Buffer</h3><p>因为 string 类型底层就是一个 byte 数组,所以我们就可以 go 语言的 bytes.Buffer 进行字符串拼接.bytes.Buffer 是一个一个缓冲 byte 类型的缓冲器,这个缓冲器里存放着都是 byte.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
buf<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span><span class="token string">&quot;asong&quot;</span><span class="token punctuation">)</span>
buf<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_1-5-6-切片-append" tabindex="-1"><a class="header-anchor" href="#_1-5-6-切片-append" aria-hidden="true">#</a> 1.5.6. 切片 append</h3><p>因为 string 类型底层也是 byte 类型数组,所以我们可以重新声明一个切片,使用 append 进行字符串拼接,使用方式如下:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>a <span class="token operator">:=</span> <span class="token string">&quot;Hello,&quot;</span>
b <span class="token operator">:=</span> <span class="token string">&quot;World!&quot;</span>
s <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果想减少内存分配,在将[]byte 转换为 string 类型时可以考虑使用强制转换.</p><h2 id="_1-6-数组-array-和切片-slice-的区别" tabindex="-1"><a class="header-anchor" href="#_1-6-数组-array-和切片-slice-的区别" aria-hidden="true">#</a> 1.6. 数组(array)和切片(slice)的区别</h2><ol><li>数组的长度不可变, 数组是值类型, 数组作为参数在函数中传递时, 传递的是数组的副本</li><li>slice是不定长的, slice是引用类型,切片的底层结构体保存着切片的容量,长度以及指向数组的指针</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> slice <span class="token keyword">struct</span> <span class="token punctuation">{</span>  
    array unsafe<span class="token punctuation">.</span>Pointer
    <span class="token builtin">len</span>   <span class="token builtin">int</span>
    <span class="token builtin">cap</span>   <span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_1-7-切片长度和容量区别" tabindex="-1"><a class="header-anchor" href="#_1-7-切片长度和容量区别" aria-hidden="true">#</a> 1.7. 切片长度和容量区别</h2><p><code>make([]int, 0, 5)</code></p><ol><li>切片的长度是它所包含的元素个数.</li><li>切片的容量是它的底层数组元素的个数.当切片的底层数组不足以容纳所有给定值时,它就会分配一个更大的数组.返回的切片会指向这个新分配的数组.</li><li>切片的长度和容量可通过 len() 和 cap() 来获取</li></ol><h2 id="_1-8-for-range-循环遍历-slice-map-有什么问题" tabindex="-1"><a class="header-anchor" href="#_1-8-for-range-循环遍历-slice-map-有什么问题" aria-hidden="true">#</a> 1.8. for-range 循环遍历 slice/map 有什么问题?</h2><p>for-range 遍历slice/map, 迭代变量的值是值拷贝,而不是元素的引用, 迭代变量总是指向同一个内存地址, 所以不能用来修改原 slice/map 中值, 可以通过索引直接修改值.</p><h3 id="_1-8-1-slice-遍历" tabindex="-1"><a class="header-anchor" href="#_1-8-1-slice-遍历" aria-hidden="true">#</a> 1.8.1. slice 遍历</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
 <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>v <span class="token operator">:=</span><span class="token keyword">range</span> slice<span class="token punctuation">{</span>
  <span class="token keyword">if</span> v<span class="token operator">==</span><span class="token number">1</span> <span class="token punctuation">{</span>
   v<span class="token operator">=</span><span class="token number">100</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token operator">:=</span><span class="token keyword">range</span> slice<span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;k:&quot;</span><span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token string">&quot;v:&quot;</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// k: 0 v: 0</span>
<span class="token comment">// k: 1 v: 1</span>
<span class="token comment">// k: 2 v: 2</span>
<span class="token comment">// k: 3 v: 3</span>


<span class="token comment">// 使用 k根据索引直接修改值.</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token operator">:=</span><span class="token keyword">range</span> slice<span class="token punctuation">{</span>
  <span class="token keyword">if</span> v<span class="token operator">==</span><span class="token number">1</span> <span class="token punctuation">{</span>
   slice<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">100</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_1-8-2-map-遍历" tabindex="-1"><a class="header-anchor" href="#_1-8-2-map-遍历" aria-hidden="true">#</a> 1.8.2. map 遍历</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 s <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span>
 m <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span>
 <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> s <span class="token punctuation">{</span>
  m<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>v
 <span class="token punctuation">}</span>
 <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;map[%v]=%v\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token operator">*</span>value<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// map[2]=4</span>
<span class="token comment">// map[3]=4</span>
<span class="token comment">// map[0]=4</span>
<span class="token comment">// map[1]=4</span>


<span class="token comment">// 声明一个中间变量,保存value,并且复制给map即可</span>
<span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 s <span class="token operator">:=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span>
 m <span class="token operator">:=</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span>
 <span class="token keyword">for</span> k<span class="token punctuation">,</span>v<span class="token operator">:=</span><span class="token keyword">range</span> s<span class="token punctuation">{</span>
  n<span class="token operator">:=</span>v
  m<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token operator">&amp;</span>n
 <span class="token punctuation">}</span>
 <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;map[%v]=%v\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token operator">*</span>value<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="_1-9-golang中-int-int8-int16-int32-int64的区别和取值" tabindex="-1"><a class="header-anchor" href="#_1-9-golang中-int-int8-int16-int32-int64的区别和取值" aria-hidden="true">#</a> 1.9. golang中 int int8 int16 int32 int64的区别和取值</h2><h3 id="_1-9-1-区别" tabindex="-1"><a class="header-anchor" href="#_1-9-1-区别" aria-hidden="true">#</a> 1.9.1. 区别</h3><table><thead><tr><th style="text-align:left;">int</th><th style="text-align:right;">类型大小为 4/8 字节</th></tr></thead><tbody><tr><td style="text-align:left;">int8</td><td style="text-align:right;">类型大小为 1 字节</td></tr><tr><td style="text-align:left;">int16</td><td style="text-align:right;">类型大小为 2 字节</td></tr><tr><td style="text-align:left;">int32</td><td style="text-align:right;">类型大小为 4 字节</td></tr><tr><td style="text-align:left;">int64</td><td style="text-align:right;">类型大小为 8 字节</td></tr></tbody></table><p>int的大小是和操作系统位数相关的,如果是32位操作系统,int类型的大小就是4字节; 如果是64位操作系统,int类型的大小就是8个字节</p><h3 id="_1-9-2-取值范围" tabindex="-1"><a class="header-anchor" href="#_1-9-2-取值范围" aria-hidden="true">#</a> 1.9.2. 取值范围</h3><table><thead><tr><th style="text-align:left;">int8</th><th style="text-align:right;">-128 ~ 127</th></tr></thead><tbody><tr><td style="text-align:left;">int16</td><td style="text-align:right;">-32768 ~ 32767</td></tr><tr><td style="text-align:left;">int32</td><td style="text-align:right;">-2147483648 ~ 2147483647</td></tr><tr><td style="text-align:left;">int64</td><td style="text-align:right;">-9223372036854775808 ~ 9223372036854775807</td></tr><tr><td style="text-align:left;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:left;">uint8</td><td style="text-align:right;">0 ~ 255</td></tr><tr><td style="text-align:left;">uint16</td><td style="text-align:right;">0 ~ 65535</td></tr><tr><td style="text-align:left;">uint32</td><td style="text-align:right;">0 ~ 4294967295</td></tr><tr><td style="text-align:left;">uint64</td><td style="text-align:right;">0 ~ 18446744073709551615</td></tr></tbody></table><h2 id="_1-10-介绍-rune-类型" tabindex="-1"><a class="header-anchor" href="#_1-10-介绍-rune-类型" aria-hidden="true">#</a> 1.10. 介绍 rune 类型</h2><p>rune 是 int32 的别名,用于区分字符值和整数值.rune代表一个utf-8字符. 当需要处理中文,日文或者其他复合字符时,则需要用到rune类型</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">&quot;你好吗&quot;</span>
runes <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">rune</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
runes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;啊&#39;</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>runes<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_1-11-golang-中解析-tag-是怎么实现的-反射原理是什么" tabindex="-1"><a class="header-anchor" href="#_1-11-golang-中解析-tag-是怎么实现的-反射原理是什么" aria-hidden="true">#</a> 1.11. golang 中解析 tag 是怎么实现的?反射原理是什么?</h2><p>声明struct结构体的时候,属性的右侧还有反引号括起来的内容, 在golang中叫标签(Tag),在转换成其它数据格式的时候,会使用其中特定的字段作为键值</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token number">1</span> <span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token number">2</span>     UserId   <span class="token builtin">int</span>    <span class="token string">`json:&quot;user_id&quot; gorm:&quot;user_id&quot;`</span>
<span class="token number">3</span>     UserName <span class="token builtin">string</span> <span class="token string">`json:&quot;user_name&quot; gorm:&quot;user_name&quot;`</span>
<span class="token number">4</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_1-12-golang-传参是值传递还是引用传递" tabindex="-1"><a class="header-anchor" href="#_1-12-golang-传参是值传递还是引用传递" aria-hidden="true">#</a> 1.12. golang 传参是值传递还是引用传递?</h2><p>go语言中所有的传参都是值传递,值的副本或引用类型的副本.无论是值类型的变量还是引用类型的变量作为参数传递都会发生值拷贝,开辟新的内存空间.</p><h2 id="_1-13-struct-能不能进行比较" tabindex="-1"><a class="header-anchor" href="#_1-13-struct-能不能进行比较" aria-hidden="true">#</a> 1.13. struct 能不能进行比较?</h2><ol><li>不同类型的 struct 不能进行比较,编译期就会报错</li><li>同类型的struct 分两种情况: <ol><li>struct 的所有成员都是可以比较的,则该 strcut 的不同实例可以比较</li><li>struct 中含有不可比较的成员,则该 struct 不可以比较</li></ol></li></ol><blockquote><p>golang 中 Slice,Map,Function 这三种数据类型是不可比较的</p></blockquote><h2 id="_1-14-go-闭包" tabindex="-1"><a class="header-anchor" href="#_1-14-go-闭包" aria-hidden="true">#</a> 1.14. go 闭包</h2><p>闭包是一个函数内引用了外部的局部变量, 闭包中引用的外部局部变量并不会随着函数的返回而被从栈上销毁.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">func</span> <span class="token function">adder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    sum <span class="token operator">:=</span> <span class="token number">0</span>
    <span class="token comment">// 闭包, 匿名函数</span>
    <span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>x <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> x
        <span class="token keyword">return</span> sum
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     valueFunc<span class="token operator">:=</span> <span class="token function">adder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
     fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">valueFunc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment">// output: 2</span>
     fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">valueFunc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// output: 4</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_1-15-golang-map-是线程安全的吗-go-如何解决-map-并发读写安全问题" tabindex="-1"><a class="header-anchor" href="#_1-15-golang-map-是线程安全的吗-go-如何解决-map-并发读写安全问题" aria-hidden="true">#</a> 1.15. golang map 是线程安全的吗? go 如何解决 Map 并发读写安全问题 ?</h2><p>map不是线程安全的, map 变量为引用类型变量,并发写时,多个协程同时操作一个内存会发生竞争关系</p><h3 id="_1-15-1-使用sync-map或第三方包-concurrent-map" tabindex="-1"><a class="header-anchor" href="#_1-15-1-使用sync-map或第三方包-concurrent-map" aria-hidden="true">#</a> 1.15.1. 使用sync.Map或第三方包 &quot;concurrent-map&quot;</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;sync&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> m1 sync<span class="token punctuation">.</span>Map
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    i<span class="token punctuation">:</span> <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">{</span>
            i<span class="token operator">++</span>
            m1<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">{</span>
            time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>m1<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_1-15-2-加锁" tabindex="-1"><a class="header-anchor" href="#_1-15-2-加锁" aria-hidden="true">#</a> 1.15.2. 加锁</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 同时只能有一个 goroutine 能够获得写锁定, 同时可以有任意多个 gorouinte 获得读锁定, 同时只能存在写锁定或读锁定(读写互斥).</span>
<span class="token keyword">var</span> <span class="token punctuation">(</span>
 rwL <span class="token operator">=</span> sync<span class="token punctuation">.</span>RWMutex<span class="token punctuation">{</span><span class="token punctuation">}</span>
 m   <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">//不加锁的话 有可能是读的错误的值</span>
<span class="token keyword">func</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">defer</span> rwL<span class="token punctuation">.</span><span class="token function">RUnlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 rwL<span class="token punctuation">.</span><span class="token function">RLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;read &quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//如果不加锁 会报错 fatal error: concurrent map writes</span>
<span class="token keyword">func</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">defer</span> rwL<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 rwL<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">rwLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
  <span class="token keyword">go</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
  <span class="token keyword">go</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment">//vari()</span>
 <span class="token comment">//mp()</span>
 <span class="token function">rwLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="_1-16-map-中删除一个-key-它的内存会释放么" tabindex="-1"><a class="header-anchor" href="#_1-16-map-中删除一个-key-它的内存会释放么" aria-hidden="true">#</a> 1.16. map 中删除一个 key, 它的内存会释放么?</h2><ol><li>如果删除的元素是值类型,如 int,float,bool,string,array, struct, 则 map 的内存不会自动释放</li><li>如果删除的元素是引用类型,如指针,slice,map,chan 等, 则 map 的内存会自动释放,但释放的内存是子元素应用类型的内存占用</li><li>将 map 设置为 nil 后,内存被回收</li></ol><h2 id="_1-17-空-map-和未初始化-map-注意事项" tabindex="-1"><a class="header-anchor" href="#_1-17-空-map-和未初始化-map-注意事项" aria-hidden="true">#</a> 1.17. 空 map 和未初始化 map 注意事项</h2><h3 id="_1-17-1-空-map-已初始化map" tabindex="-1"><a class="header-anchor" href="#_1-17-1-空-map-已初始化map" aria-hidden="true">#</a> 1.17.1. 空 map (已初始化map)</h3><p>空map可以正常取赋值, 断定 map 是空还是 nil, 需要通过 map == nil 来判断. 因为通过 fmt 打印 map 时,空 map 和 nil map 结果是一样的</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 使用make函数初始化map</span>
m1 <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> m1 <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;空map, 不是nil&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_1-17-2-未初始化-map" tabindex="-1"><a class="header-anchor" href="#_1-17-2-未初始化-map" aria-hidden="true">#</a> 1.17.2. 未初始化 map</h3><ol><li>对未初始化的 map 取值, 值为空:</li><li>对未初始化的 map 赋值, 抛出异常</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> m1 <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;空map 取值: %v\n&quot;</span><span class="token punctuation">,</span> m1<span class="token punctuation">[</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// </span>
m1<span class="token punctuation">[</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span>                        <span class="token comment">//   panic: assignment to entry in nil map</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_1-18-map-的数据结构是什么-是怎么实现扩容" tabindex="-1"><a class="header-anchor" href="#_1-18-map-的数据结构是什么-是怎么实现扩容" aria-hidden="true">#</a> 1.18. map 的数据结构是什么?是怎么实现扩容?</h2><p>go 中的 map 在底层是用哈希表实现的, 哈希表示的是键值对之间映射关系.</p><p>随着 Map 中元素的增加,发生哈希冲突的概率会增加,Map 的读写性能也会下降,所以需要更大的内存来保证 Map 的读写性能. 当装载因子超过某个阈值(6.5)时,会动态地增加 Map 长度,实现自动扩容.</p><h2 id="_1-19-map-如何顺序读取" tabindex="-1"><a class="header-anchor" href="#_1-19-map-如何顺序读取" aria-hidden="true">#</a> 1.19. map 如何顺序读取?</h2><p>map 不能顺序读取, 想要有序读取, 所以可以把key 放入切片进行排序</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;sort&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    m <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
    m<span class="token punctuation">[</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span>
    m<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span>
    m<span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;3&quot;</span>

    keys <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> k<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
        keys <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//  排序</span>
    sort<span class="token punctuation">.</span><span class="token function">Strings</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> k <span class="token operator">:=</span> <span class="token keyword">range</span> keys <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Key:%+v, Value:%+v\n&quot;</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span> m<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_1-20-简单描述-go-语言-gc-垃圾回收-的工作原理" tabindex="-1"><a class="header-anchor" href="#_1-20-简单描述-go-语言-gc-垃圾回收-的工作原理" aria-hidden="true">#</a> 1.20. 简单描述 go 语言 GC(垃圾回收)的工作原理</h2><p>垃圾回收(GC)是在后台运行一个守护线程,监控各个对象的状态,识别并且丢弃不再使用的对象, 来释放和重用资源.</p><p>golang使用的垃圾回收机制是三色标记法,是对标记清除法的改进.</p><h3 id="_1-20-1-标记清除" tabindex="-1"><a class="header-anchor" href="#_1-20-1-标记清除" aria-hidden="true">#</a> 1.20.1. 标记清除</h3><ol><li>标记阶段 - 从根对象出发标记堆中存活的对象</li><li>清除阶段 - 遍历堆中所有对象,回收未被标记的垃圾对象</li></ol><h4 id="_1-20-1-1-缺点" tabindex="-1"><a class="header-anchor" href="#_1-20-1-1-缺点" aria-hidden="true">#</a> 1.20.1.1. 缺点</h4><p>GC 执行期间需要把整个程序完全暂停,不能异步进行 GC 操作</p><h3 id="_1-20-2-三色标记" tabindex="-1"><a class="header-anchor" href="#_1-20-2-三色标记" aria-hidden="true">#</a> 1.20.2. 三色标记</h3><p>三色标记优点是可以异步执行,从而可以以中断时间极少的代价或者完全没有中断操作来进行整个GC.</p><p>三色标记算法将程序中的对象分成白色,黑色和灰色三类,初始都是白色</p><ol><li>白色,初始值.本次回收没被扫描过的对象默认都是白色的.而确认不可达的对象也是白色,但是会被标记「不可达」.</li><li>灰色,中间状态.本对象有被外部引用,但是本对象引用的其它对象尚未全部检测完.</li><li>黑色,本对象有被其它对象引用,且已检测完本对象引用的其它对象.</li></ol><h4 id="_1-20-2-1-垃圾回收过程" tabindex="-1"><a class="header-anchor" href="#_1-20-2-1-垃圾回收过程" aria-hidden="true">#</a> 1.20.2.1. 垃圾回收过程</h4><ol><li>垃圾回收开始时,将程序所有对象,包括新创建的对象,全部标记为白色,并将白色对象放入到白色标记表集合中;</li><li>每次GC回收开始, 然后从根节点开始遍历所有对象,把遍历到的对象从白色集合放入&quot;灰色&quot;集合.</li><li>遍历灰色集合,将灰色对象引用的对象从白色集合放入灰色集合,之后将此灰色对象放入黑色集合</li><li>重复上一步, 直到灰色中无任何对象.</li><li>回收所有的白色标记表的对象. 也就是回收垃圾.</li></ol><h4 id="_1-20-2-2-触发条件" tabindex="-1"><a class="header-anchor" href="#_1-20-2-2-触发条件" aria-hidden="true">#</a> 1.20.2.2. 触发条件</h4><ol><li>手动触发: 一般很少用,主要由开发者通过调用 runtime.GC()</li><li>系统触发: <ol><li>当前分配的内存达到一定阈值时触发,这个阈值在每次GC过后都会根据堆内存的增长情况和CPU占用率来调整</li><li>自从上次GC后, 间隔时间达到了2分钟,将启动GC</li></ol></li></ol><h2 id="_1-21-为什么小对象多了会造成gc压力" tabindex="-1"><a class="header-anchor" href="#_1-21-为什么小对象多了会造成gc压力" aria-hidden="true">#</a> 1.21. 为什么小对象多了会造成GC压力</h2><p>通常小对象过多会导致GC三色法消耗过多的GPU.优化思路是,减少对象分配.</p><h2 id="_1-22-请简述-go-是如何分配内存的" tabindex="-1"><a class="header-anchor" href="#_1-22-请简述-go-是如何分配内存的" aria-hidden="true">#</a> 1.22. 请简述 go 是如何分配内存的?</h2><ol><li>栈内存由编译器自动分配和释放,开发者无法控制.栈内存一般存储函数中的局部变量,参数等,函数创建的时候,这些内存会被自动创建;函数返回的时候,这些内存会被自动释放.</li><li>堆内存的生命周期比栈内存要长,如果函数返回的值还会在其他地方使用,那么这个值就会被编译器自动分配到堆上.</li><li>堆内存相比栈内存来说,不能自动被编译器释放,只能通过垃圾回收器才能释放,所以栈内存效率会很高.</li></ol><h2 id="_1-23-client-如何实现长连接" tabindex="-1"><a class="header-anchor" href="#_1-23-client-如何实现长连接" aria-hidden="true">#</a> 1.23. client 如何实现长连接?</h2><p>在 golang 中使用持久化连接发起 HTTP 请求,主要依赖 Transport,官方封装的 net 库中已经支持,在实际应用中,需要在初始化 HTTP 的 client 时传入 transport,</p><h3 id="_1-23-1-transport-的主要功能" tabindex="-1"><a class="header-anchor" href="#_1-23-1-transport-的主要功能" aria-hidden="true">#</a> 1.23.1. Transport 的主要功能</h3><ol><li>缓存了长连接,用于大量 http 请求场景下的连接复用</li><li>对连接做一些限制,连接超时时间,每个 host 的最大连接数</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;io/ioutil&quot;</span>
    <span class="token string">&quot;net&quot;</span>
    <span class="token string">&quot;net/http&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> HTTPTransport <span class="token operator">=</span> <span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Transport<span class="token punctuation">{</span>
    DialContext<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>net<span class="token punctuation">.</span>Dialer<span class="token punctuation">{</span>
        Timeout<span class="token punctuation">:</span>   <span class="token number">30</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span> <span class="token comment">// 连接超时时间</span>
        KeepAlive<span class="token punctuation">:</span> <span class="token number">60</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span> <span class="token comment">// 保持长连接的时间</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>DialContext<span class="token punctuation">,</span> <span class="token comment">// 设置连接的参数</span>
    MaxIdleConns<span class="token punctuation">:</span>          <span class="token number">500</span><span class="token punctuation">,</span> <span class="token comment">// 最大空闲连接</span>
    IdleConnTimeout<span class="token punctuation">:</span>       <span class="token number">60</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span> <span class="token comment">// 空闲连接的超时时间</span>
    ExpectContinueTimeout<span class="token punctuation">:</span> <span class="token number">30</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span> <span class="token comment">// 等待服务第一个响应的超时时间</span>
    MaxIdleConnsPerHost<span class="token punctuation">:</span>   <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 每个host保持的空闲连接数</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    times <span class="token operator">:=</span> <span class="token number">50</span>
    uri <span class="token operator">:=</span> <span class="token string">&quot;http://local.test.com/t.php&quot;</span>

    <span class="token comment">// 短连接的情况</span>
    start <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    client <span class="token operator">:=</span> http<span class="token punctuation">.</span>Client<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 初始化http的client</span>


    <span class="token comment">// 长连接的情况</span>
    start2 <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 初始化一个带有transport的http的client</span>
    client2 <span class="token operator">:=</span> http<span class="token punctuation">.</span>Client<span class="token punctuation">{</span>Transport<span class="token punctuation">:</span> HTTPTransport<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="_1-24-分布式锁的问题吗-分布式锁的原理你清楚吗" tabindex="-1"><a class="header-anchor" href="#_1-24-分布式锁的问题吗-分布式锁的原理你清楚吗" aria-hidden="true">#</a> 1.24. 分布式锁的问题吗?分布式锁的原理你清楚吗?</h2><p>golang 中的分布式锁可使用 etcd 进行实现,实现原理如下:</p><ol><li>利用租约在 etcd 集群中创建一个 key,这个 key 有两种形态,存在和不存在,而这两种 形态就是互斥量.</li><li>如果这个 key 不存在,那么线程创建 key,成功则获取到锁,该 key 就为存在状态.</li><li>如果该 key 已经存在,那么线程就不能创建 key,则获取锁失败.</li></ol><h2 id="_1-25-go-实现-set-类型" tabindex="-1"><a class="header-anchor" href="#_1-25-go-实现-set-类型" aria-hidden="true">#</a> 1.25. go 实现 set 类型</h2><p>go 没有Set 类型的,Set 可以看做元素不能重复的list, go 提供了 map 类型, map 类型的 key 是不能重复的, 可以来实现一个 set.value 可以用一个常量来代替,比如一个空结构体,空结构体不占任何内存</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Empty <span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token comment">//set类型</span>
<span class="token keyword">type</span> Set <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span>Empty
<span class="token punctuation">}</span>
<span class="token comment">//返回一个set</span>
<span class="token keyword">func</span> <span class="token function">SetFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Set<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>Set<span class="token punctuation">{</span>
        m<span class="token punctuation">:</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span>Empty<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//添加元素</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Set<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>val <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s<span class="token punctuation">.</span>m<span class="token punctuation">[</span>val<span class="token punctuation">]</span> <span class="token operator">=</span> empty
<span class="token punctuation">}</span>

<span class="token comment">//删除元素</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Set<span class="token punctuation">)</span> <span class="token function">Remove</span><span class="token punctuation">(</span>val <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">delete</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>m<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//获取长度</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Set<span class="token punctuation">)</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>m<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//清空set</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Set<span class="token punctuation">)</span> <span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span>Empty<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//遍历set</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Set<span class="token punctuation">)</span> <span class="token function">Traverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>m <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//排序输出 </span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Set<span class="token punctuation">)</span> <span class="token function">SortTraverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    vals <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> s<span class="token punctuation">.</span>m <span class="token punctuation">{</span>
        vals <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>vals<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//排序</span>
    sort<span class="token punctuation">.</span><span class="token function">Ints</span><span class="token punctuation">(</span>vals<span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> vals <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h2 id="_1-26-了解空指针吗" tabindex="-1"><a class="header-anchor" href="#_1-26-了解空指针吗" aria-hidden="true">#</a> 1.26. 了解空指针吗</h2><p><code>var ptr *int</code></p><p>当一个指针被声明而未初始化时,它的值为 nil, 即为空指针. nil代表零值或空值.</p><h2 id="_1-27-内存逃逸" tabindex="-1"><a class="header-anchor" href="#_1-27-内存逃逸" aria-hidden="true">#</a> 1.27. 内存逃逸</h2><h3 id="_1-27-1-什么是内存逃逸" tabindex="-1"><a class="header-anchor" href="#_1-27-1-什么是内存逃逸" aria-hidden="true">#</a> 1.27.1. 什么是内存逃逸?</h3><p>在程序中,每个函数块都会有自己的内存区域用来存自己的局部变量(内存占用少),返回地址,返回值之类的数据,这一块内存区域有特定的结构和寻址方式,寻址起来十分迅速,开销很少.这一块内存地址称为栈.栈是线程级别的,大小在创建的时候已经确定,当变量太大的时候,会&quot;逃逸&quot;到堆上,这种现象称为内存逃逸.简单来说,局部变量通过堆分配和回收,就叫内存逃逸.</p><h3 id="_1-27-2-逃逸是如何产生的" tabindex="-1"><a class="header-anchor" href="#_1-27-2-逃逸是如何产生的" aria-hidden="true">#</a> 1.27.2. 逃逸是如何产生的?</h3><p>如果一个函数返回对一个变量的引用,那么它就会发生逃逸.即任何时候,一个值被分享到函数栈范围之外,它都会在堆上被重新分配.在这里有一个例外,就是如果编译器可以证明在函数返回后不会再被引用的,那么就会分配到栈上,这个证明的过程叫做逃逸分析.</p><h3 id="_1-27-3-总结" tabindex="-1"><a class="header-anchor" href="#_1-27-3-总结" aria-hidden="true">#</a> 1.27.3. 总结</h3><p>如果函数外部没有引用,则优先放到栈中; 如果函数外部存在引用,则必定放到堆中;</p><h3 id="_1-27-4-内存逃逸的危害" tabindex="-1"><a class="header-anchor" href="#_1-27-4-内存逃逸的危害" aria-hidden="true">#</a> 1.27.4. 内存逃逸的危害</h3><p>堆是一块没有特定结构,也没有固定大小的内存区域,可以根据需要进行调整.全局变量,内存占用较大的局部变量,函数调用结束后不能立刻回收的局部变量都会存在堆里面.变量在堆上的分配和回收都比在栈上开销大的多.对于 go 这种带 GC 的语言来说,会增加 gc 压力,同时也容易造成内存碎片(采用分区式存储管理的系统,在储存分配过程中产生的,不能供用户作业使用的主存里的小分区称成&quot;内存碎片&quot;.内存碎片分为内部碎片和外部碎片).</p><h3 id="_1-27-5-demo" tabindex="-1"><a class="header-anchor" href="#_1-27-5-demo" aria-hidden="true">#</a> 1.27.5. demo</h3><p><code>go run -gcflags &quot;-m -l&quot; main.go</code></p><p>使用 go run 运行程序时,-gcflags 参数是编译参数.其中 -m 表示进行内存分配分析,-l 表示避免程序内联,也就是避免进行程序优化. <img src="/audition/assets/img/1647688069247.ef9559d4.png" alt="picture 8"></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">demo</span><span class="token punctuation">(</span>user <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token comment">//声名一个变量并赋值</span>
     <span class="token keyword">var</span> admin <span class="token builtin">int</span> 
     admin <span class="token operator">=</span> user
     <span class="token keyword">return</span> admin
<span class="token punctuation">}</span>
<span class="token comment">//空的没啥用的方法</span>
<span class="token keyword">func</span> <span class="token function">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// 声明user变量并打印</span>
    <span class="token keyword">var</span> user <span class="token builtin">int</span> 
    <span class="token function">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 存在内存逃逸</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_1-28-golang的init函数" tabindex="-1"><a class="header-anchor" href="#_1-28-golang的init函数" aria-hidden="true">#</a> 1.28. golang的init函数</h2><p>初始化每个包后,会自动执行 init()函数,init函数执行优先级高于main函数的执行优先级</p><h3 id="_1-28-1-init函数的主要特点" tabindex="-1"><a class="header-anchor" href="#_1-28-1-init函数的主要特点" aria-hidden="true">#</a> 1.28.1. init函数的主要特点</h3><ol><li>init函数先于main函数自动执行,不能被其他函数调用;</li><li>init函数没有入参, 返回值;</li><li>每个包可以有多个init函数;</li><li>包的每个源文件也可以有多个init函数, init()调用顺序是从上到下</li><li>同包的不同文件按文件名字符串比较, &quot;从小到大&quot;顺序调用各文件中的init()函数.</li><li>不同包的init函数按照包导入的依赖关系决定执行顺序.</li></ol><h2 id="_1-29-go语言局部变量分配在栈还是堆" tabindex="-1"><a class="header-anchor" href="#_1-29-go语言局部变量分配在栈还是堆" aria-hidden="true">#</a> 1.29. go语言局部变量分配在栈还是堆</h2><p>函数内局部变量,它会被分配在堆还是栈,是由编译器做逃逸分析之后自动做出的决定.</p><h2 id="_1-30-golang函数返回局部变量的指针是否安全" tabindex="-1"><a class="header-anchor" href="#_1-30-golang函数返回局部变量的指针是否安全" aria-hidden="true">#</a> 1.30. golang函数返回局部变量的指针是否安全</h2><p>安全, go 编译器将会对每个局部变量进行逃逸分析.如果发现局部变量的作用域超出该函数,则不会将内存分配在栈上,而是分配在堆上</p><h2 id="_1-31-go中两个nil可能不相等吗" tabindex="-1"><a class="header-anchor" href="#_1-31-go中两个nil可能不相等吗" aria-hidden="true">#</a> 1.31. go中两个nil可能不相等吗</h2><p>两个nil只有在类型相同时才相等.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code> <span class="token keyword">var</span> p <span class="token operator">*</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">nil</span>
 <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token boolean">nil</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p <span class="token operator">==</span> i<span class="token punctuation">)</span>

<span class="token comment">// false</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_1-32-非接口的任意类型-t-能够调用-t-的方法吗-反过来呢" tabindex="-1"><a class="header-anchor" href="#_1-32-非接口的任意类型-t-能够调用-t-的方法吗-反过来呢" aria-hidden="true">#</a> 1.32. 非接口的任意类型 T() 能够调用 *T 的方法吗? 反过来呢?</h2><ol><li>一个T类型的值可以调用为<code>*T</code>类型声明的方法,但是仅当此T的值是可寻址的情况下.编译器在调用指针属主方法前,会自动取此T值的地址.因为不是任何T值都是可寻址的,所以并非任何T值都能够调用为类型*T声明的方法.</li><li>一个<code>*T</code>类型的值可以调用为类型T声明的方法,这是因为解引用指针总是合法的.</li></ol><h2 id="_1-33-golang判断map中key是否存在的方法" tabindex="-1"><a class="header-anchor" href="#_1-33-golang判断map中key是否存在的方法" aria-hidden="true">#</a> 1.33. golang判断map中key是否存在的方法</h2><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dict <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;key2&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> dict<span class="token punctuation">[</span><span class="token string">&quot;key1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;key1 不存在&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_1-34-golang比较两个字符串切片是否相等" tabindex="-1"><a class="header-anchor" href="#_1-34-golang比较两个字符串切片是否相等" aria-hidden="true">#</a> 1.34. golang比较两个字符串切片是否相等</h2><p>遍历比较切片中的每一个元素</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">CompareSlice</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token function">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> a <span class="token punctuation">{</span>
  <span class="token keyword">if</span> value <span class="token operator">!=</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_1-35-go-打印结构体-使用-v-v-v-的区别" tabindex="-1"><a class="header-anchor" href="#_1-35-go-打印结构体-使用-v-v-v-的区别" aria-hidden="true">#</a> 1.35. go 打印结构体, 使用 %v %+v %#v 的区别</h2><ol><li>%v 输出所有的值</li><li>%+v 输出结构体(字段名字+字段的值)</li><li>%#v 先输出结构体变量名,再输出结构体(字段名字+字段的值)</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
 id   <span class="token builtin">int32</span>
 name <span class="token builtin">string</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> <span class="token operator">&amp;</span>student<span class="token punctuation">{</span>id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">&quot;xiaoming&quot;</span><span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%v \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v \n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

<span class="token comment">// output:</span>
<span class="token comment">// &amp;{1 xiaoming} </span>
<span class="token comment">// &amp;{id:1 name:xiaoming} </span>
<span class="token comment">// &amp;main.student{id:1, name:&quot;xiaoming&quot;} </span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="_1-36-golang的枚举类型" tabindex="-1"><a class="header-anchor" href="#_1-36-golang的枚举类型" aria-hidden="true">#</a> 1.36. golang的枚举类型</h2><p>go语言并没有提供enum的定义,可以使用const来模拟枚举类型.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">const</span> <span class="token punctuation">(</span>
    Running <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">iota</span>
    Pending
    Stopped
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;State running: &quot;</span><span class="token punctuation">,</span> Running<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;State pending: &quot;</span><span class="token punctuation">,</span> Pending<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;State Stoped: &quot;</span><span class="token punctuation">,</span> Stopped<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_1-37-go-空结构体-struct-的用途" tabindex="-1"><a class="header-anchor" href="#_1-37-go-空结构体-struct-的用途" aria-hidden="true">#</a> 1.37. go 空结构体 struct{} 的用途</h2><p>空结构体 struct{} 不占据内存空间, 通常作为占位符使用.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 s <span class="token operator">:=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 0 </span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_1-38-go中的nil切片和空切片区别" tabindex="-1"><a class="header-anchor" href="#_1-38-go中的nil切片和空切片区别" aria-hidden="true">#</a> 1.38. go中的nil切片和空切片区别</h2><ol><li>nil slice 未分配内存, 只是声明了slice</li><li>empty slice 已分配内存</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> slice <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
slice<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">//err</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>slice <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
slice <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_1-39-go的defer原理是什么" tabindex="-1"><a class="header-anchor" href="#_1-39-go的defer原理是什么" aria-hidden="true">#</a> 1.39. go的defer原理是什么</h2><h3 id="_1-39-1-如何理解-defer-关键字" tabindex="-1"><a class="header-anchor" href="#_1-39-1-如何理解-defer-关键字" aria-hidden="true">#</a> 1.39.1. 如何理解 defer 关键字</h3><p>defer 用于延迟执行一个函数. 常用于处理如资源释放,连接关闭等问题, 会在函数返回之前进行调用</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// A</span>
<span class="token comment">// C</span>
<span class="token comment">// B</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_1-39-2-多个-defer-的顺序" tabindex="-1"><a class="header-anchor" href="#_1-39-2-多个-defer-的顺序" aria-hidden="true">#</a> 1.39.2. 多个 defer 的顺序</h3><p>如果有多个defer 表达式,执行顺序为先进后出, 类似于栈.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// c</span>
<span class="token comment">// b</span>
<span class="token comment">// a</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_1-39-3-defer-在什么时候会修改返回值" tabindex="-1"><a class="header-anchor" href="#_1-39-3-defer-在什么时候会修改返回值" aria-hidden="true">#</a> 1.39.3. defer 在什么时候会修改返回值?</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;return:&quot;</span><span class="token punctuation">,</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 打印结果为 return: 2</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>i <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 提前声明了返回值i</span>
 <span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  i<span class="token operator">++</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;defer2:&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token comment">// 打印结果为 defer: 2</span>
 <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  i<span class="token operator">++</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;defer1:&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token comment">// 打印结果为 defer: 1</span>
 <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">return</span> i <span class="token comment">// 或者直接 return 效果相同</span>
<span class="token punctuation">}</span>

<span class="token comment">// 函数的返回值提前声明,这使得defer可以直接访问该返回值,  return最先执行,return负责</span>
<span class="token comment">// 将结果写入返回值中;接着defer开始执行一些收尾工作;最后函数携带当前返回值退出.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_1-39-3-defer-recover-的问题" tabindex="-1"><a class="header-anchor" href="#_1-39-3-defer-recover-的问题" aria-hidden="true">#</a> 1.39.3. defer recover 的问题?</h3><p>不建议在编写普通函数时也经常性使用这种特性</p><p>panic 终止程序的运行,recover 捕获异常,程序在发生错误后,我们能够做一些处理,保证程序可以继续运行,那么这时候,我们就需要使用异常恢复,即 recover.golang 中的 recover 一般都是配套 defer 一起使用.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> r <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> r <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Recovered in f&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_1-40-闭包与匿名函数" tabindex="-1"><a class="header-anchor" href="#_1-40-闭包与匿名函数" aria-hidden="true">#</a> 1.40. 闭包与匿名函数</h2><p>defer 经常使用到闭包与匿名函数.</p><ol><li>匿名函数:没有函数名的函数.</li><li>闭包:可以使用另外一个函数作用域中的变量的函数.</li></ol><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">intSeq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    i <span class="token operator">:=</span> <span class="token number">0</span>
    <span class="token comment">//  闭包, 匿名函数</span>
    <span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
        i<span class="token operator">++</span>
        <span class="token keyword">return</span> i
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_1-41-go的-slice如何扩容" tabindex="-1"><a class="header-anchor" href="#_1-41-go的-slice如何扩容" aria-hidden="true">#</a> 1.41. go的 slice如何扩容</h2><p>slice是可以看做是一个长度可变的数组.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> slice <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token comment">// 指向一个数组的指针</span>
 array unsafe<span class="token punctuation">.</span>Pointer
<span class="token comment">// 切片的长度</span>
 <span class="token builtin">len</span>   <span class="token builtin">int</span>
<span class="token comment">//  切片的容量</span>
 <span class="token builtin">cap</span>   <span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>在对slice进行append等操作时,可能会造成slice的自动扩容.</p><ol><li>如果切片的容量小于1024个元素,那么扩容的时候slice的cap就乘以2;一旦元素个数超过1024个元素,增长因子就变成1.25,即每次增加原来容量的四分之一.</li><li>slice 扩容后,还没有触及到原数组的容量,那么 slice 中的数组指针依然指向原数组.</li><li>slice 扩容后,超过了原数组的容量,那么 Go 会开辟一块新的内存,把原数组拷贝进去,slice 中的数组指针指向新数组.</li></ol><h2 id="_1-42-同步-异步和阻塞-非阻塞的区别" tabindex="-1"><a class="header-anchor" href="#_1-42-同步-异步和阻塞-非阻塞的区别" aria-hidden="true">#</a> 1.42. 同步, 异步和阻塞, 非阻塞的区别?</h2><p>同步是个过程,阻塞是线程的一种状态</p><h3 id="_1-42-1-同步和异步的区别" tabindex="-1"><a class="header-anchor" href="#_1-42-1-同步和异步的区别" aria-hidden="true">#</a> 1.42.1. 同步和异步的区别</h3><p>同步与异步是线程之间的关系,两个线程之间要么是同步的,要么是异步的.</p><ol><li>同步: 发起一个请求, 必须要等到响应结果才能发起下一个请求.</li><li>异步: 发起一个请求, 不需要等到响应结果就能发起下一个请求.</li></ol><h3 id="_1-42-2-阻塞与非阻塞的区别" tabindex="-1"><a class="header-anchor" href="#_1-42-2-阻塞与非阻塞的区别" aria-hidden="true">#</a> 1.42.2. 阻塞与非阻塞的区别</h3><p>阻塞与非阻塞是是程序在等待响应结果时的状态, 对同一个线程来说的,在某个时刻,线程要么处于阻塞,要么处于非阻塞</p><ol><li>阻塞:调用结果返回之前,当前线程会被挂起,一直处于等待消息通知,不能够执行其他业务,函数只有在得到结果之后才会返回.</li><li>非阻塞:在不能立刻得到结果之前,该函数不会阻塞当前线程,而会立刻返回.</li></ol><h2 id="_1-43-golang-中切片去重" tabindex="-1"><a class="header-anchor" href="#_1-43-golang-中切片去重" aria-hidden="true">#</a> 1.43. golang 中切片去重</h2><h3 id="_1-43-1-双重循环过滤" tabindex="-1"><a class="header-anchor" href="#_1-43-1-双重循环过滤" aria-hidden="true">#</a> 1.43.1. 双重循环过滤</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 通过两重循环过滤重复元素</span>
<span class="token keyword">func</span> <span class="token function">RemoveRepByLoop</span><span class="token punctuation">(</span>slc <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
 result <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 存放结果</span>
 <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> slc <span class="token punctuation">{</span>
  flag <span class="token operator">:=</span> <span class="token boolean">true</span>
  <span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token keyword">range</span> result <span class="token punctuation">{</span>
   <span class="token keyword">if</span> slc<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> result<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">{</span>
    flag <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 存在重复元素,标识为false</span>
    <span class="token keyword">break</span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> flag <span class="token punctuation">{</span> <span class="token comment">// 标识为false,不添加进结果</span>
   result <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> slc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="_1-43-2-通过字典-set-过滤" tabindex="-1"><a class="header-anchor" href="#_1-43-2-通过字典-set-过滤" aria-hidden="true">#</a> 1.43.2. 通过字典(set)过滤</h3><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 通过map主键唯一的特性过滤重复元素</span>
<span class="token keyword">func</span> <span class="token function">RemoveRepByMap</span><span class="token punctuation">(</span>slc <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
    result <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    tempMap <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">// 存放不重复主键</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> e <span class="token operator">:=</span> <span class="token keyword">range</span> slc<span class="token punctuation">{</span>
        l <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>tempMap<span class="token punctuation">)</span>
        tempMap<span class="token punctuation">[</span>e<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>tempMap<span class="token punctuation">)</span> <span class="token operator">!=</span> l<span class="token punctuation">{</span>  <span class="token comment">// 加入map后,map长度变化,则元素不重复</span>
            result <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">6/12/2022, 2:31:30 AM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: shorestraydog@protonmail.com">shorestraydog</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: root@DESKTOP-VKU4PE6.localdomain">root</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/audition/golang/codingstandard.html" class="nav-link" aria-label="1. Go 语言编码规范"><!--[--><!--]--> 1. Go 语言编码规范 <!--[--><!--]--></a></span><span class="next"><a href="/audition/golang/concurrency.html" class="nav-link" aria-label="1. concurrency"><!--[--><!--]--> 1. concurrency <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/audition/assets/js/runtime~app.d53e597b.js" defer></script><script src="/audition/assets/js/812.cf73d600.js" defer></script><script src="/audition/assets/js/app.44937fea.js" defer></script>
  </body>
</html>
